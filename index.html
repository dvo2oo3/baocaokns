<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>B√°o C√°o Ti·∫øn ƒê·ªô C√†i Ph·∫ßn M·ªÅm</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }
        
        .stat-card {
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
        }
        .stat-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 30px 60px -12px rgba(0, 0, 0, 0.3);
        }
        .pulse-dot {
            animation: pulse 2s cubic-bezier(0.4, 0, 0.6, 1) infinite;
        }
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: .5; }
        }
        .fade-in {
            animation: fadeIn 0.6s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(30px); }
            to { opacity: 1; transform: translateY(0); }
        }
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #6366f1;
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 0.8s linear infinite;
            display: inline-block;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        .glass-effect {
            background: rgba(255, 255, 255, 0.95);
            backdrop-filter: blur(20px);
            border: 1px solid rgba(255, 255, 255, 0.4);
        }
        .section-divider {
            height: 3px;
            background: linear-gradient(90deg, transparent, rgba(139, 92, 246, 0.5), transparent);
            margin: 2rem 0;
        }
    </style>
</head>
<body class="bg-gradient-to-br from-indigo-50 via-purple-50 to-pink-50 min-h-screen p-4 md:p-8">
    <div class="max-w-7xl mx-auto">
        
        <!-- Header -->
        <div class="glass-effect rounded-3xl shadow-2xl p-6 md:p-8 mb-8 fade-in">
            <div class="flex flex-col lg:flex-row items-start lg:items-center justify-between gap-6">
                <div class="flex-1">
                    <div class="flex items-center gap-4 mb-3">
                        <div class="bg-gradient-to-br from-indigo-500 to-purple-600 p-4 rounded-2xl shadow-xl">
                            <span class="text-5xl">üìö</span>
                        </div>
                        <div>
                            <h1 class="text-3xl md:text-5xl font-black bg-gradient-to-r from-indigo-600 via-purple-600 to-pink-600 bg-clip-text text-transparent leading-tight">
                                Ti·∫øn ƒê·ªô C√†i ƒê·∫∑t
                            </h1>
                            <p class="text-gray-600 mt-2 font-semibold text-lg">Ph·∫ßn M·ªÅm K·ªπ NƒÉng S·ªëng</p>
                        </div>
                    </div>
                    <div class="flex items-center gap-3 mt-4">
                        <div id="statusIndicator" class="w-3 h-3 rounded-full bg-gray-400 pulse-dot"></div>
                        <p class="text-sm text-gray-600 font-medium" id="lastUpdate">ƒêang t·∫£i d·ªØ li·ªáu...</p>
                    </div>
                </div>
                <div class="flex gap-3">
                    <button 
                        onclick="toggleAutoRefresh()" 
                        id="autoRefreshBtn"
                        class="flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 px-5 py-3 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl border-2 border-gray-200">
                        <span id="autoRefreshIcon" class="text-xl">‚è∏Ô∏è</span>
                        <span class="hidden sm:inline">Auto</span>
                    </button>
                    <button 
                        onclick="fetchData()" 
                        id="refreshBtn"
                        class="flex items-center gap-2 bg-gradient-to-r from-indigo-600 to-purple-600 hover:from-indigo-700 hover:to-purple-700 text-white px-6 py-3 rounded-xl font-bold transition-all shadow-lg hover:shadow-2xl">
                        <span id="refreshIcon" class="text-xl">üîÑ</span>
                        <span>L√†m m·ªõi</span>
                    </button>
                </div>
            </div>
        </div>

        <!-- PH·∫¶N 1: TH·ªêNG K√ä TR∆Ø·ªúNG -->
        <div class="mb-6 md:mb-8 fade-in">
            <div class="flex items-center gap-2 md:gap-3 mb-4 md:mb-6">
                <div class="bg-gradient-to-r from-blue-500 to-blue-600 p-1.5 md:p-2 rounded-lg">
                    <span class="text-xl md:text-2xl">üè´</span>
                </div>
                <h2 class="text-xl md:text-3xl font-black bg-gradient-to-r from-blue-600 to-blue-700 bg-clip-text text-transparent">
                    Th·ªëng K√™ Tr∆∞·ªùng
                </h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                <!-- T·ªïng s·ªë tr∆∞·ªùng -->
                <div class="stat-card bg-gradient-to-br from-blue-500 to-blue-600 rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 text-white">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <span class="text-3xl md:text-5xl">üè´</span>
                        <div class="bg-white bg-opacity-25 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-sm font-black">TOTAL</span>
                        </div>
                    </div>
                    <h3 class="text-sm md:text-base font-bold opacity-90 mb-2 md:mb-3">T·ªïng s·ªë tr∆∞·ªùng</h3>
                    <p class="text-4xl md:text-6xl font-black mb-1 md:mb-2" id="totalSchools">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-xs md:text-sm opacity-80">tr∆∞·ªùng ƒëƒÉng k√Ω</p>
                </div>

                <!-- Tr∆∞·ªùng ƒë√£ c√†i -->
                <div class="stat-card bg-gradient-to-br from-indigo-500 to-indigo-600 rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 text-white">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <span class="text-3xl md:text-5xl">‚úÖ</span>
                        <div class="bg-white bg-opacity-25 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-sm font-black" id="schoolPercent">0%</span>
                        </div>
                    </div>
                    <h3 class="text-sm md:text-base font-bold opacity-90 mb-2 md:mb-3">Tr∆∞·ªùng ƒë√£ c√†i</h3>
                    <p class="text-4xl md:text-6xl font-black mb-1 md:mb-2" id="schoolsInstalled">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-xs md:text-sm opacity-80" id="schoolsInstalledSub">0/192</p>
                </div>

                <!-- Tr∆∞·ªùng m√°y > 10 -->
                <div class="stat-card bg-gradient-to-br from-purple-500 to-purple-600 rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 text-white">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <span class="text-3xl md:text-5xl">üíª</span>
                        <div class="bg-white bg-opacity-25 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-sm font-black">PC</span>
                        </div>
                    </div>
                    <h3 class="text-sm md:text-base font-bold opacity-90 mb-2 md:mb-3">Tr∆∞·ªùng m√°y > 10</h3>
                    <p class="text-4xl md:text-6xl font-black mb-1 md:mb-2" id="moreThan10">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-xs md:text-sm opacity-80">tr∆∞·ªùng</p>
                </div>
            </div>

            <!-- Progress Bar Tr∆∞·ªùng -->
            <div class="mt-4 md:mt-6 glass-effect rounded-xl md:rounded-2xl shadow-xl p-4 md:p-6">
                <div class="flex items-center justify-between mb-3 md:mb-4">
                    <h3 class="text-base md:text-xl font-black text-gray-800">Ti·∫øn ƒë·ªô tr∆∞·ªùng</h3>
                    <span class="text-2xl md:text-3xl font-black bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent" id="installProgress">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-5 md:h-6 overflow-hidden">
                    <div id="installProgressBar" class="bg-gradient-to-r from-blue-500 to-indigo-600 h-5 md:h-6 rounded-full transition-all duration-1000 ease-out shadow-lg flex items-center justify-end pr-2 md:pr-3" style="width: 0%">
                        <span class="text-white text-xs font-bold" id="installProgressText"></span>
                    </div>
                </div>
                <p class="text-xs md:text-sm text-gray-600 mt-2" id="installProgressSub">0/192 tr∆∞·ªùng</p>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- PH·∫¶N 2: TH·ªêNG K√ä GI√ÅO VI√äN -->
        <div class="mb-6 md:mb-8 fade-in">
            <div class="flex items-center gap-2 md:gap-3 mb-4 md:mb-6">
                <div class="bg-gradient-to-r from-green-500 to-emerald-600 p-1.5 md:p-2 rounded-lg">
                    <span class="text-xl md:text-2xl">üë•</span>
                </div>
                <h2 class="text-xl md:text-3xl font-black bg-gradient-to-r from-green-600 to-emerald-700 bg-clip-text text-transparent">
                    Th·ªëng K√™ Gi√°o Vi√™n
                </h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                <!-- GV ƒëƒÉng k√Ω -->
                <div class="stat-card bg-gradient-to-br from-green-500 to-emerald-600 rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 text-white">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <span class="text-3xl md:text-5xl">üë•</span>
                        <div class="bg-white bg-opacity-25 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-sm font-black">TOTAL</span>
                        </div>
                    </div>
                    <h3 class="text-sm md:text-base font-bold opacity-90 mb-2 md:mb-3">GV ƒëƒÉng k√Ω</h3>
                    <p class="text-4xl md:text-6xl font-black mb-1 md:mb-2" id="registered">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-xs md:text-sm opacity-80">gi√°o vi√™n</p>
                </div>

                <!-- GV ƒë√£ c√†i -->
                <div class="stat-card bg-gradient-to-br from-teal-500 to-teal-600 rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 text-white">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <span class="text-3xl md:text-5xl">‚úÖ</span>
                        <div class="bg-white bg-opacity-25 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-sm font-black" id="installedPercent">0%</span>
                        </div>
                    </div>
                    <h3 class="text-sm md:text-base font-bold opacity-90 mb-2 md:mb-3">GV ƒë√£ c√†i</h3>
                    <p class="text-4xl md:text-6xl font-black mb-1 md:mb-2" id="installed">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-xs md:text-sm opacity-80" id="installedSub">0/0</p>
                </div>

                <!-- GV c√≤n l·∫°i -->
                <div class="stat-card bg-gradient-to-br from-orange-500 to-red-500 rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 text-white">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <span class="text-3xl md:text-5xl">‚è≥</span>
                        <div class="bg-white bg-opacity-25 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-sm font-black" id="remainingPercent2">0%</span>
                        </div>
                    </div>
                    <h3 class="text-sm md:text-base font-bold opacity-90 mb-2 md:mb-3">GV ch∆∞a c√†i</h3>
                    <p class="text-4xl md:text-6xl font-black mb-1 md:mb-2" id="remaining">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-xs md:text-sm opacity-80">gi√°o vi√™n</p>
                </div>
            </div>

            <!-- Progress Bar GV -->
            <div class="mt-4 md:mt-6 glass-effect rounded-xl md:rounded-2xl shadow-xl p-4 md:p-6">
                <div class="flex items-center justify-between mb-3 md:mb-4">
                    <h3 class="text-base md:text-xl font-black text-gray-800">Ti·∫øn ƒë·ªô gi√°o vi√™n</h3>
                    <span class="text-2xl md:text-3xl font-black bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent" id="teacherProgress">0%</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-5 md:h-6 overflow-hidden">
                    <div id="teacherProgressBar" class="bg-gradient-to-r from-green-500 to-emerald-600 h-5 md:h-6 rounded-full transition-all duration-1000 ease-out shadow-lg flex items-center justify-end pr-2 md:pr-3" style="width: 0%">
                        <span class="text-white text-xs font-bold" id="teacherProgressText"></span>
                    </div>
                </div>
                <p class="text-xs md:text-sm text-gray-600 mt-2" id="teacherProgressSub">0/0 GV</p>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- PH·∫¶N 3: PH√ÇN B·ªî S·ªê TI·∫æT -->
        <div class="mb-6 md:mb-8 fade-in">
            <div class="flex items-center gap-2 md:gap-3 mb-4 md:mb-6">
                <div class="bg-gradient-to-r from-yellow-500 to-orange-500 p-1.5 md:p-2 rounded-lg">
                    <span class="text-xl md:text-2xl">üìñ</span>
                </div>
                <h2 class="text-xl md:text-3xl font-black bg-gradient-to-r from-yellow-600 to-orange-600 bg-clip-text text-transparent">
                    Ph√¢n B·ªï S·ªë Ti·∫øt
                </h2>
            </div>
            
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 md:gap-6">
                <!-- 36 ti·∫øt -->
                <div class="stat-card glass-effect rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 border-2 md:border-4 border-blue-200">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <div class="flex items-center gap-2 md:gap-3">
                            <div class="bg-gradient-to-br from-blue-400 to-blue-600 p-2 md:p-4 rounded-lg md:rounded-xl shadow-lg">
                                <span class="text-2xl md:text-4xl">üìò</span>
                            </div>
                            <h3 class="text-lg md:text-2xl font-black text-blue-900">36 ti·∫øt</h3>
                        </div>
                        <div class="bg-blue-100 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-base font-black text-blue-700" id="percent36">0%</span>
                        </div>
                    </div>
                    <p class="text-4xl md:text-6xl font-black text-blue-900 mb-2 md:mb-3" id="install36">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-sm md:text-base text-blue-700 font-bold">tr∆∞·ªùng ƒëƒÉng k√Ω</p>
                </div>
                
                <!-- 72 ti·∫øt -->
                <div class="stat-card glass-effect rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 border-2 md:border-4 border-green-200">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <div class="flex items-center gap-2 md:gap-3">
                            <div class="bg-gradient-to-br from-green-400 to-green-600 p-2 md:p-4 rounded-lg md:rounded-xl shadow-lg">
                                <span class="text-2xl md:text-4xl">üìó</span>
                            </div>
                            <h3 class="text-lg md:text-2xl font-black text-green-900">72 ti·∫øt</h3>
                        </div>
                        <div class="bg-green-100 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-base font-black text-green-700" id="percent72">0%</span>
                        </div>
                    </div>
                    <p class="text-4xl md:text-6xl font-black text-green-900 mb-2 md:mb-3" id="install72">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-sm md:text-base text-green-700 font-bold">tr∆∞·ªùng ƒëƒÉng k√Ω</p>
                </div>
                
                <!-- 108 ti·∫øt -->
                <div class="stat-card glass-effect rounded-xl md:rounded-2xl shadow-xl p-5 md:p-8 border-2 md:border-4 border-yellow-200">
                    <div class="flex items-center justify-between mb-3 md:mb-4">
                        <div class="flex items-center gap-2 md:gap-3">
                            <div class="bg-gradient-to-br from-yellow-400 to-orange-500 p-2 md:p-4 rounded-lg md:rounded-xl shadow-lg">
                                <span class="text-2xl md:text-4xl">üìô</span>
                            </div>
                            <h3 class="text-lg md:text-2xl font-black text-yellow-900">108 ti·∫øt</h3>
                        </div>
                        <div class="bg-yellow-100 rounded-lg md:rounded-xl px-2 md:px-4 py-1 md:py-2">
                            <span class="text-xs md:text-base font-black text-yellow-700" id="percent108">0%</span>
                        </div>
                    </div>
                    <p class="text-4xl md:text-6xl font-black text-yellow-900 mb-2 md:mb-3" id="install108">
                        <span class="loading-spinner"></span>
                    </p>
                    <p class="text-sm md:text-base text-yellow-700 font-bold">tr∆∞·ªùng ƒëƒÉng k√Ω</p>
                </div>
            </div>
        </div>

        <div class="section-divider"></div>

        <!-- BI·ªÇU ƒê·ªí -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-4 md:gap-6 mb-6 md:mb-8 fade-in">
            <!-- Bar Chart -->
            <div class="glass-effect rounded-xl md:rounded-2xl shadow-2xl p-4 md:p-6">
                <div class="flex items-center justify-between mb-4 md:mb-6">
                    <h2 class="text-lg md:text-2xl font-black bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent flex items-center gap-2 md:gap-3">
                        <span class="text-2xl md:text-3xl">üìä</span>
                        <span class="hidden sm:inline">Th·ªëng k√™ t·ªïng quan</span>
                        <span class="sm:hidden">T·ªïng quan</span>
                    </h2>
                </div>
                <div style="height: 280px; background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); border-radius: 0.75rem; padding: 1rem;">
                    <canvas id="barChart"></canvas>
                </div>
            </div>
            
            <!-- Pie Chart -->
            <div class="glass-effect rounded-xl md:rounded-2xl shadow-2xl p-4 md:p-6">
                <div class="flex items-center justify-between mb-4 md:mb-6">
                    <h2 class="text-lg md:text-2xl font-black bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent flex items-center gap-2 md:gap-3">
                        <span class="text-2xl md:text-3xl">ü•ß</span>
                        <span class="hidden sm:inline">Ph√¢n b·ªï s·ªë ti·∫øt</span>
                        <span class="sm:hidden">S·ªë ti·∫øt</span>
                    </h2>
                </div>
                <div style="height: 280px; background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%); border-radius: 0.75rem; padding: 1rem;">
                    <canvas id="pieChart"></canvas>
                </div>
            </div>
        </div>

        <!-- PH√ÇN T√çCH N√ÇNG CAO -->
        <div class="glass-effect rounded-xl md:rounded-3xl shadow-2xl p-5 md:p-8 fade-in">
            <h2 class="text-xl md:text-3xl font-black text-center mb-5 md:mb-8 bg-gradient-to-r from-indigo-600 to-purple-600 bg-clip-text text-transparent">
                üìà Ph√¢n T√≠ch N√¢ng Cao
            </h2>
            <div class="grid grid-cols-2 lg:grid-cols-4 gap-3 md:gap-6">
                <div class="text-center bg-gradient-to-br from-blue-50 to-blue-100 rounded-xl md:rounded-2xl p-4 md:p-6 border-2 border-blue-300">
                    <div class="text-3xl md:text-5xl mb-2 md:mb-4">üè´</div>
                    <p class="text-gray-700 text-xs md:text-sm font-bold mb-2 md:mb-3">T·ª∑ l·ªá tr∆∞·ªùng</p>
                    <p class="text-3xl md:text-5xl font-black bg-gradient-to-r from-blue-600 to-indigo-600 bg-clip-text text-transparent mb-1 md:mb-2" id="schoolCompletionRate">0%</p>
                    <p class="text-xs text-gray-600 font-semibold" id="schoolCompletionSub">0/192</p>
                </div>
                <div class="text-center bg-gradient-to-br from-green-50 to-green-100 rounded-xl md:rounded-2xl p-4 md:p-6 border-2 border-green-300">
                    <div class="text-3xl md:text-5xl mb-2 md:mb-4">üë®‚Äçüè´</div>
                    <p class="text-gray-700 text-xs md:text-sm font-bold mb-2 md:mb-3">T·ª∑ l·ªá GV</p>
                    <p class="text-3xl md:text-5xl font-black bg-gradient-to-r from-green-600 to-emerald-600 bg-clip-text text-transparent mb-1 md:mb-2" id="teacherCompletionRate">0%</p>
                    <p class="text-xs text-gray-600 font-semibold" id="teacherCompletionSub">0/0</p>
                </div>
                <div class="text-center bg-gradient-to-br from-purple-50 to-purple-100 rounded-xl md:rounded-2xl p-4 md:p-6 border-2 border-purple-300">
                    <div class="text-3xl md:text-5xl mb-2 md:mb-4">‚ö°</div>
                    <p class="text-gray-700 text-xs md:text-sm font-bold mb-2 md:mb-3">T·ªëc ƒë·ªô</p>
                    <p class="text-2xl md:text-4xl font-black bg-gradient-to-r from-purple-600 to-pink-600 bg-clip-text text-transparent mb-1 md:mb-2" id="deploymentSpeed">-</p>
                    <p class="text-xs text-gray-600 font-semibold">GV/ng√†y</p>
                </div>
                <div class="text-center bg-gradient-to-br from-orange-50 to-orange-100 rounded-xl md:rounded-2xl p-4 md:p-6 border-2 border-orange-300">
                    <div class="text-3xl md:text-5xl mb-2 md:mb-4">üìÖ</div>
                    <p class="text-gray-700 text-xs md:text-sm font-bold mb-2 md:mb-3">Ho√†n th√†nh</p>
                    <p class="text-2xl md:text-4xl font-black bg-gradient-to-r from-orange-600 to-red-600 bg-clip-text text-transparent mb-1 md:mb-2" id="estimatedCompletion">-</p>
                    <p class="text-xs text-gray-600 font-semibold">c√≤n l·∫°i</p>
                </div>
            </div>
        </div>

    </div>

    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script>
        const SHEET_ID = '1XRwutbGBYRj_gclLjcWc5E4sbP5nKdbehJfb8heWr-g';
        const SHEET_NAME = 'T·ªïng';
        const AUTO_REFRESH_INTERVAL = 30000;
        const TOTAL_SCHOOLS = 192;
        
        let barChart, pieChart;
        let autoRefreshEnabled = false;
        let autoRefreshTimer = null;
        let lastFetchTime = null;

        function parseValue(cellValue) {
            if (cellValue === null || cellValue === undefined) return 0;
            if (typeof cellValue === 'number') return cellValue;
            
            if (typeof cellValue === 'string') {
                cellValue = cellValue.trim();
                if (cellValue.includes('C√≤n L·∫°i:')) {
                    const match = cellValue.match(/C√≤n L·∫°i:\s*(\d+)/i);
                    return match ? parseInt(match[1]) : 0;
                }
                if (cellValue.includes('/')) {
                    const match = cellValue.match(/(\d+)\s*\//);
                    return match ? parseInt(match[1]) : 0;
                }
                const numMatch = cellValue.match(/^(\d+)/);
                if (numMatch) return parseInt(numMatch[1]);
                const num = parseInt(cellValue.replace(/\D/g, ''));
                return isNaN(num) ? 0 : num;
            }
            return 0;
        }

        function toggleAutoRefresh() {
            autoRefreshEnabled = !autoRefreshEnabled;
            const btn = document.getElementById('autoRefreshBtn');
            const icon = document.getElementById('autoRefreshIcon');
            
            if (autoRefreshEnabled) {
                btn.className = 'flex items-center gap-2 bg-green-500 hover:bg-green-600 text-white px-5 py-3 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl border-2 border-green-600';
                icon.textContent = '‚ñ∂Ô∏è';
                autoRefreshTimer = setInterval(fetchData, AUTO_REFRESH_INTERVAL);
            } else {
                btn.className = 'flex items-center gap-2 bg-white hover:bg-gray-50 text-gray-700 px-5 py-3 rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl border-2 border-gray-200';
                icon.textContent = '‚è∏Ô∏è';
                if (autoRefreshTimer) {
                    clearInterval(autoRefreshTimer);
                    autoRefreshTimer = null;
                }
            }
        }

        async function fetchData() {
            const btn = document.getElementById('refreshBtn');
            const icon = document.getElementById('refreshIcon');
            
            btn.disabled = true;
            icon.className = 'loading-spinner';

            try {
                const cells = ['R4', 'R5', 'R6', 'O4', 'O9', 'O10', 'O12', 'O13', 'O14'];
                
                const responses = await Promise.all(
                    cells.map(cell => 
                        fetch(`https://docs.google.com/spreadsheets/d/${SHEET_ID}/gviz/tq?tqx=out:json&sheet=${SHEET_NAME}&range=${cell}`)
                    )
                );
                
                const values = await Promise.all(
                    responses.map(async (response) => {
                        if (!response.ok) return 0;
                        const text = await response.text();
                        const json = JSON.parse(text.substring(47).slice(0, -2));
                        
                        if (json.table && json.table.rows && json.table.rows[0]) {
                            const cellValue = json.table.rows[0].c[0]?.v;
                            return parseValue(cellValue);
                        }
                        return 0;
                    })
                );
                
                const data = {
                    approvedInstall: values[0] || 0,
                    installed: values[1] || 0,
                    remainingTeachers: values[2] || 0,
                    totalRegistered: values[3] || TOTAL_SCHOOLS,
                    schoolsInstalled: values[4] || 0,
                    moreThan10PC: values[5] || 0,
                    install36: values[6] || 0,
                    install72: values[7] || 0,
                    install108: values[8] || 0
                };
                
                updateUI(data);
                lastFetchTime = new Date();
                
                document.getElementById('statusIndicator').className = 'w-3 h-3 rounded-full bg-green-500 pulse-dot';
                document.getElementById('lastUpdate').textContent = '‚úÖ C·∫≠p nh·∫≠t: ' + lastFetchTime.toLocaleString('vi-VN');
                
            } catch (error) {
                console.error('Error:', error);
                document.getElementById('statusIndicator').className = 'w-3 h-3 rounded-full bg-red-500 pulse-dot';
                document.getElementById('lastUpdate').textContent = '‚ùå L·ªói: ' + error.message;
            } finally {
                btn.disabled = false;
                icon.className = '';
                icon.textContent = 'üîÑ';
            }
        }

        function updateUI(data) {
            // PH·∫¶N 1: TR∆Ø·ªúNG
            document.getElementById('totalSchools').textContent = TOTAL_SCHOOLS;
            document.getElementById('schoolsInstalled').textContent = data.schoolsInstalled;
            
            const schoolPercent = ((data.schoolsInstalled / TOTAL_SCHOOLS) * 100).toFixed(1);
            document.getElementById('schoolPercent').textContent = schoolPercent + '%';
            document.getElementById('schoolsInstalledSub').textContent = `${data.schoolsInstalled}/${TOTAL_SCHOOLS}`;
            
            document.getElementById('moreThan10').textContent = data.moreThan10PC;
            
            document.getElementById('installProgress').textContent = schoolPercent + '%';
            document.getElementById('installProgressSub').textContent = `${data.schoolsInstalled}/${TOTAL_SCHOOLS} tr∆∞·ªùng`;
            document.getElementById('installProgressBar').style.width = schoolPercent + '%';
            document.getElementById('installProgressText').textContent = schoolPercent + '%';
            
            // PH·∫¶N 2: GI√ÅO VI√äN
            document.getElementById('registered').textContent = data.approvedInstall;
            document.getElementById('installed').textContent = data.installed;
            
            const teacherPercent = data.approvedInstall > 0 
                ? ((data.installed / data.approvedInstall) * 100).toFixed(1) 
                : 0;
            document.getElementById('installedPercent').textContent = teacherPercent + '%';
            document.getElementById('installedSub').textContent = `${data.installed}/${data.approvedInstall}`;
            
            document.getElementById('remaining').textContent = data.remainingTeachers;
            const remainingPercent = data.approvedInstall > 0 
                ? ((data.remainingTeachers / data.approvedInstall) * 100).toFixed(1) 
                : 0;
            document.getElementById('remainingPercent2').textContent = remainingPercent + '%';
            
            document.getElementById('teacherProgress').textContent = teacherPercent + '%';
            document.getElementById('teacherProgressSub').textContent = `${data.installed}/${data.approvedInstall} GV`;
            document.getElementById('teacherProgressBar').style.width = teacherPercent + '%';
            document.getElementById('teacherProgressText').textContent = teacherPercent + '%';
            
            // PH·∫¶N 3: S·ªê TI·∫æT
            const totalPeriods = data.install36 + data.install72 + data.install108;
            
            document.getElementById('install36').textContent = data.install36;
            document.getElementById('percent36').textContent = totalPeriods > 0 
                ? ((data.install36 / totalPeriods) * 100).toFixed(1) + '%' 
                : '0%';
            
            document.getElementById('install72').textContent = data.install72;
            document.getElementById('percent72').textContent = totalPeriods > 0 
                ? ((data.install72 / totalPeriods) * 100).toFixed(1) + '%' 
                : '0%';
            
            document.getElementById('install108').textContent = data.install108;
            document.getElementById('percent108').textContent = totalPeriods > 0 
                ? ((data.install108 / totalPeriods) * 100).toFixed(1) + '%' 
                : '0%';

            // PH√ÇN T√çCH N√ÇNG CAO
            document.getElementById('schoolCompletionRate').textContent = schoolPercent + '%';
            document.getElementById('schoolCompletionSub').textContent = `${data.schoolsInstalled}/${TOTAL_SCHOOLS} tr∆∞·ªùng`;
            
            document.getElementById('teacherCompletionRate').textContent = teacherPercent + '%';
            document.getElementById('teacherCompletionSub').textContent = `${data.installed}/${data.approvedInstall} GV`;
            
            const daysElapsed = 30;
            const speedPerDay = (data.installed / daysElapsed).toFixed(1);
            document.getElementById('deploymentSpeed').textContent = speedPerDay;
            
            if (data.remainingTeachers > 0 && speedPerDay > 0) {
                const daysRemaining = Math.ceil(data.remainingTeachers / speedPerDay);
                document.getElementById('estimatedCompletion').textContent = `~${daysRemaining} ng√†y`;
            } else {
                document.getElementById('estimatedCompletion').textContent = '‚úÖ Xong';
            }

            updateCharts(data);
        }

        function updateCharts(data) {
            if (barChart) barChart.destroy();
            if (pieChart) pieChart.destroy();

            // Bar Chart
            const barCtx = document.getElementById('barChart').getContext('2d');
            barChart = new Chart(barCtx, {
                type: 'bar',
                data: {
                    labels: ['T·ªïng tr∆∞·ªùng', 'Tr∆∞·ªùng ƒë√£ c√†i', 'GV ƒëƒÉng k√Ω', 'GV ƒë√£ c√†i', 'GV c√≤n l·∫°i'],
                    datasets: [{
                        label: 'S·ªë l∆∞·ª£ng',
                        data: [
                            TOTAL_SCHOOLS,
                            data.schoolsInstalled, 
                            data.approvedInstall, 
                            data.installed,
                            data.remainingTeachers
                        ],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.85)',
                            'rgba(99, 102, 241, 0.85)',
                            'rgba(16, 185, 129, 0.85)',
                            'rgba(20, 184, 166, 0.85)',
                            'rgba(249, 115, 22, 0.85)'
                        ],
                        borderColor: [
                            'rgba(59, 130, 246, 1)',
                            'rgba(99, 102, 241, 1)',
                            'rgba(16, 185, 129, 1)',
                            'rgba(20, 184, 166, 1)',
                            'rgba(249, 115, 22, 1)'
                        ],
                        borderWidth: 3,
                        borderRadius: 10,
                        borderSkipped: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { 
                            display: false 
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 16,
                            titleFont: { size: 16, weight: 'bold' },
                            bodyFont: { size: 14 },
                            cornerRadius: 12,
                            displayColors: true,
                            boxWidth: 12,
                            boxHeight: 12,
                            boxPadding: 8
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            grid: {
                                color: 'rgba(0, 0, 0, 0.05)',
                                lineWidth: 1
                            },
                            ticks: {
                                font: { size: 12, weight: '600' },
                                color: '#4b5563'
                            }
                        },
                        x: {
                            grid: {
                                display: false
                            },
                            ticks: {
                                font: { size: 11, weight: '600' },
                                color: '#4b5563'
                            }
                        }
                    }
                }
            });

            // Pie Chart
            const pieCtx = document.getElementById('pieChart').getContext('2d');
            
            pieChart = new Chart(pieCtx, {
                type: 'doughnut',
                data: {
                    labels: ['36 ti·∫øt', '72 ti·∫øt', '108 ti·∫øt'],
                    datasets: [{
                        data: [data.install36, data.install72, data.install108],
                        backgroundColor: [
                            'rgba(59, 130, 246, 0.9)',
                            'rgba(34, 197, 94, 0.9)',
                            'rgba(251, 191, 36, 0.9)'
                        ],
                        borderColor: '#fff',
                        borderWidth: 4,
                        hoverOffset: 15
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: {
                        legend: {
                            position: 'bottom',
                            labels: {
                                padding: 20,
                                font: { size: 14, weight: '600' },
                                color: '#374151',
                                usePointStyle: true,
                                pointStyle: 'circle'
                            }
                        },
                        tooltip: {
                            backgroundColor: 'rgba(0, 0, 0, 0.9)',
                            padding: 16,
                            cornerRadius: 12,
                            titleFont: { size: 16, weight: 'bold' },
                            bodyFont: { size: 14 },
                            callbacks: {
                                label: function(context) {
                                    const value = context.parsed;
                                    const total = context.dataset.data.reduce((a, b) => a + b, 0);
                                    const percentage = total > 0 ? ((value / total) * 100).toFixed(1) : 0;
                                    return `${context.label}: ${value} tr∆∞·ªùng (${percentage}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }

        window.onload = () => {
            fetchData();
        };
    </script>
</body>
</html>